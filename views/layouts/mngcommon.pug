head
  // Required meta tags
  meta(charset='utf-8')
  meta(name='viewport', content='width=device-width, initial-scale=1, shrink-to-fit=no')
  meta(name='keywords', content='Trường TH Huỳnh Ngọc Huệ - Ngôi trường đáng tin cậy cho các bậc phụ huynh')
  meta(name='description', content='Địa chỉ: 158 Hà Huy Tập, Q.Thanh Khê, TP.Đà Nẵng - Điện thoại: 02363.746.027 - Website: www.thhuynhngochue.edu.vn - Email: thhuynhngochue@danang.gov.vn')
  meta(name='google-site-verification', content='mTMJWqOndj_LKOUVWTwJI5rvGRxwrQy2Xn0EEPQV_EE')
  // Global site tag (gtag.js) - Google Analytics
  script(async='', src='https://www.googletagmanager.com/gtag/js?id=G-TBNBEJB1YQ')
  script.
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TBNBEJB1YQ');

  title Trường TH Huỳnh Ngọc Huệ | #{title}
  link(rel='icon', type='image/png', href='/images/favicon.jpg')
  // Google Font
  link(href='https://fonts.googleapis.com/css?family=Lato:100,300,300i,400,400i,700,700i,900,900i', rel='stylesheet')
  // Bootstrap CSS
  link(href='/css/bootstrap/bootstrap.min.css', type='text/css', rel='stylesheet')
  // font-awesome CSS
  link(href='/css/fontawesome/font-awesome.min.css', type='text/css', rel='stylesheet')
  // owlcarousel CSS
  link(href='/css/owlcarousel/owl.carousel.min.css', type='text/css', rel='stylesheet')
  // Bootstrap CSS
  link(href='/css/style.css', type='text/css', rel='stylesheet')
  // global CSS
  link(href='/css/shotcode.css', type='text/css', rel='stylesheet')
  // main CSS
  link(href='/css/responsive.css', type='text/css', rel='stylesheet')
  // hover CSS
  link(href='/css/hover.css', type='text/css', rel='stylesheet')
  // images popup CSS
  link(href='/css/magnific-popup.css', type='text/css', rel='stylesheet')
  link(href='/css/manager.css', type='text/css', rel='stylesheet')
  // modernizr jS
  script(src='/js/modernizr-2.8.3.min.js', type='text/javascript')

.top(oncontextmenu='return false;')
  .container
    .row
      .col-lg-6.col-sm-12.mobile-center
        h2.font-dearJoe(style='margin-bottom: 5px;')
          | Xin chào trường TH Huỳnh Ngọc Huệ
      // /.col-md-6
      .col-lg-6.col-sm-12.mobile-center
        .wrap-top
          .flat-top.flat-language
            ul.unstyled
              li
                a(href='/auth/logout') Log out
  // /.row
           
  header#header.header.header-main.educare-header
    .container
      .row
        .col-lg-12
          .educare-header-wrapper
            .nav-wrap.clearfix
              nav#mainnav.mainnav
                ul.menu
                  li
                    a(href='/manager/notification') Thông báo
                  li
                    a(href='/manager/news') Tin tức sự kiện   
                            
                  li
                    a(href='/manager/activity') Hoạt động
                  li
                    a(href='#') Phản hồi
                  li
                    a(href='/trang-chu' target='_blank') Tới Trang chủ
                // /.menu
              // /.mainnav
              
              .educare-btn-menu
                span
              // //mobile menu button
            // /.nav-wrap
  nav#educare-mobile-nav.mainnav(style='display: none;')
    ul.menu
      li
        a(href='#') Quản lý
        ul.submenu
          li
            a(href='/manager/notification') Thông báo
          li
            a(href='/manager/news') Tin tức sự kiện
          
        // /.submenu
      
      li
        a(href='/manager/activity') Hoạt động
      li
        a(href='#') Phản hồi
      li
        a(href='/trang-chu' target='_blank') Tới Trang chủ
                // /.menu
    // /.menu
block content 

script(src='/js/jquery-3.3.1.min.js', type='text/javascript')
script(src='/js/popper.min.js', type='text/javascript')
script(src='/js/bootstrap/bootstrap.min.js', type='text/javascript')
  // owl carousel
script(src='/js/owlcarousel/owl.carousel.min.js', type='text/javascript')
  // parallaxie
script(src='/js/parallaxie.js', type='text/javascript')
  // To View on scroll
script(src='/js/jquery.appear.js')
  // popup inages
script(src='/js/jquery.magnific-popup.js')
  // Checkbox
script(src='/js/jquery-countTo.js')
  // main js
script(src='/js/script.js', type='text/javascript')

script.
    $(document).ready(function(req,res) {
    
    // Activate tooltip
    $('[data-toggle="tooltip"]').tooltip();
    // Select/Deselect checkboxes
    var checkbox = $('input[name="options[]"]');
    var checkAll = $('#selectAll');
    var checkAllSubmitBtnDelete = $('.check-all-submit-btn')
    var containerFormDelete = $('#deleteItemModal')
    var deleteIcon = $('.delete')
    var deleteSubmitModal = $('#deleteSubmitModal');
    var itemIds = [];
    var item = $('#edit').data('id');
    // select all checked
    checkAll.change(function(){    
    var isCheckedAll= $(this).prop('checked');
    checkbox.prop('checked',isCheckedAll);
    if (isCheckedAll){
      var data = $(this).data('id');
      data.forEach(element =>{
        if (element.notiId){
          itemIds.push(element.notiId);
        }
        if (element.newsId){
          itemIds.push(element.newsId);
        }
        
      })
    }else{
      itemIds = [];
    }
    renderCheckAllSubmitBtn();
    //- console.log(itemIds)
    })

    // item checked
    checkbox.change(function(){      
      var isCheckedAll = checkbox.length === $('input[name="options[]"]:checked').length;
      checkAll.prop('checked',isCheckedAll);
      // khi checkbox item dc checked
      if ($(this).prop('checked')){
        if ($(this).data('id').notiId){
          itemIds.push($(this).data('id').notiId)
        }
        if ($(this).data('id').newsId){
          itemIds.push($(this).data('id').newsId)
        }
      }
      // bỏ checked thì remove item khỏi itemIds
      else{
        var index;
        if ($(this).data('id').notiId){
          index = itemIds.indexOf($(this).data('id').notiId);
        }
        if ($(this).data('id').newsId){
          index = itemIds.indexOf($(this).data('id').newsId);
        }
         
        if (index > -1) {
          itemIds.splice(index, 1);
        }
      }
      renderCheckAllSubmitBtn();
      //- console.log(itemIds)
      
    });
    // Re-render check all submit btn
    function renderCheckAllSubmitBtn(){
      var checkCount = $('input[name="options[]"]:checked').length;
      if(checkCount){
        checkAllSubmitBtnDelete.removeClass('disabled')
      }else{
        checkAllSubmitBtnDelete.addClass('disabled')
      }
    }
    // Check all submit button clicked
    checkAllSubmitBtnDelete.click(function(e){
      e.preventDefault();
      var isSubmitable= !$(this).hasClass('disabled');
      if(isSubmitable){
        const removeDuplicate = new Set(itemIds);
        itemIds = Array.from(removeDuplicate);
        //- console.log(itemIds)
        $("#deleteItemModal .modal-footer #idItemDelete").val(itemIds);
        containerFormDelete.show();
     
      }
      
    });
    // delete icon
    deleteIcon.click(function(){
      var item = $(this).data('id');
      if(item.notiId){
        itemIds.push(item.notiId)
      }
      if(item.newsId){
        itemIds.push(item.newsId)
      }
      $("#deleteItemModal .modal-footer #idItemDelete").val(itemIds);
    });
    deleteSubmitModal.click(function(){
      itemIds= [];
      checkAll.prop('checked',false)
      checkbox.prop('checked',false)
    })
    
    }
    );  
    
 
script.

  // add image
  var images= [];
  
  var dataTransfer = new DataTransfer();
  function image_select(){
    var imageAdd = document.getElementById('image-upload').files;
    
    for (i=0; i<imageAdd.length;i++){
      images.push({
        "name" : imageAdd[i].name,
        "url" : URL.createObjectURL(imageAdd[i]),
        "file" : imageAdd[i],
      })
      dataTransfer.items.add(imageAdd[i]);
     } 
    document.getElementById('image-upload').files = dataTransfer.files;
    document.getElementById('image-preview-wrap').innerHTML= image_show();
    
  }
  function image_show(){
    var image = "";
    images.forEach((i)=>{
      image += `<div class="image-preview">
      <img id="imagePreview" src="`+i.url+`" alt="image" />
      <span id="spanX" class="position-absolute" onclick="delete_image(`+images.indexOf(i)+`)">&times;</span>
      </div>`;
                    
    });
    return image;
  }
  function delete_image(imagesId){
    images.splice(imagesId,1);
    dataTransfer.items.remove(imagesId);
    //- console.log(dataTransfer.files)
    //- imageAdd  = dataTransfer.files;
    document.getElementById('image-upload').files = dataTransfer.files;
    document.getElementById('image-preview-wrap').innerHTML= image_show();
  }
  


  // edit image
  // ds anh da co trc do
  var imagesEdit=[];
  var dataId;
  var dataJSON;
  var elementEdit = document.getElementsByClassName('edit');
  var dataTransferUpdate = new DataTransfer();
  //- console.log(elementEdit)
  for(var i = 0; i < elementEdit.length; i++){
    elementEdit[i].onclick = function(){
    // get data in form
    dataId = this.getAttribute('data-id');
    // convert data id sang JSON
    dataJSON = JSON.parse(dataId)
    imagesEdit = dataJSON.image;   
    // lấy các title, content, id vào input 
    document.getElementById("titleItem").value= dataJSON.title;
    document.getElementById("contentItem").value = dataJSON.content;
    if (dataJSON.newsId){
      document.getElementById("idItem").value = dataJSON.newsId;
    }
    if (dataJSON.notiId){
      document.getElementById("idItem").value = dataJSON.notiId;
    }
    // lấy link những ảnh đã có vào input
    document.getElementById("imagedList").value= JSON.stringify(dataJSON.image);
    document.getElementById('image-preview-wrap-update').innerHTML= image_show_update();
    }
  }
  
  function image_select_update(){
    var image = document.getElementById('image-upload-update').files;
    
    for (i=0; i<image.length;i++){
      imagesEdit.push({
        "name" : image[i].name,
        "link" : URL.createObjectURL(image[i]),
        "file" : image[i],
      })
      
     } 
    document.getElementsByName('ImageUpload_Update[]').value = imagesEdit
    document.getElementById('image-preview-wrap-update').innerHTML= image_show_update();
    
  }

  function image_show_update(){
    var image = "";
    imagesEdit.forEach((i)=>{
      image += `<div class="image-preview">
      <img id="imagePreview" src="`+i.link+`" alt="image" />
      <span class="position-absolute" onclick="delete_image_update(`+imagesEdit.indexOf(i)+`)">&times;</span>
      </div>`;
                    
    });
    document.getElementsByName('ImageUpload_Update[]').value = imagesEdit
    return image;
  }

  function delete_image_update(e){
    imagesEdit.splice(e,1);
    document.getElementById('image-preview-wrap-update').innerHTML= image_show_update();
    
  }

  // cancel button
  function cancelModalAdd(){
    // add
    images= [];
    dataTransfer.items.clear();
    document.getElementById('image-preview-wrap').innerHTML= image_show();
    document.getElementById("titleItemAdd").value= ""
    document.getElementById("contentItemAdd").value = ""
    document.getElementById('image-upload').value=""
    
  }
  function cancelModalEdit(){
    // edit
    
    document.getElementById('image-upload-update').value = ""
    dataJSON = JSON.parse(dataId)
    imagesEdit = dataJSON.image;
    document.getElementById('image-preview-wrap-update').innerHTML= image_show_update();
  }
script.
      document.onkeydown = function(e) {
      if (event.keyCode === 123) {
      return false;
      }
      if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
      return false
      }
      if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
      return false
      }
      if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
      return false
      }
      }
  
 

    
  
    
 
